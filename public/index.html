<html>
  <head>
    <meta charset="utf-8" />
    <title>Starter Frontend</title>
  </head>
  <body>
    <h1>Frontend Starter</h1>

    <!-- existing ping test -->
    <button id="btn">Call /api/ping</button>
    <pre id="out">Click the button...</pre>

    <hr />

    <!-- movie login + search -->
    <button id="login">Login (demo)</button>
    <input id="q" placeholder="Search movies" />
    <button id="search">Search</button>

    <script>
      // existing ping
      document.getElementById("btn").onclick = async () => {
        const res = await fetch("/api/ping");
        document.getElementById("out").textContent = await res.text();
      };

      // new movie script
      let token = "";
      document.getElementById("login").onclick = async () => {
        // register or login demo user
        await fetch("/api/auth/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email: "demo@demo.com", password: "pass123" }),
        });
        const res = await fetch("/api/auth/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email: "demo@demo.com", password: "pass123" }),
        });
        token = (await res.json()).token;
        document.getElementById("out").textContent = "Logged in âœ…";
      };

      document.getElementById("search").onclick = async () => {
        const q = document.getElementById("q").value;
        const res = await fetch(
          `/api/movies/search?q=${encodeURIComponent(q)}`
        );
        const data = await res.json();
        document.getElementById("out").textContent = JSON.stringify(
          data,
          null,
          2
        );
      };
    </script>
  </body>
</html>
